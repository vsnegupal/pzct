<p>Hi everyone!</p>
<p>In January 2022, I decided to start my own server for Project Zomboid. The conditions allowed me to use a separate computer at home for this. I was familiar with the GNU/Linux family of operating systems. So I decided that the server would run on a Linux computer.</p>
<p>Managing the server, I realized that it was not easy at all. Management was all about executing commands in the console. Different actions required different commands. You either had to memorize these commands or refer to a list of them. Commands had to be executed in a certain sequence. All of this took a lot of time.</p>
<p>At that time I knew how to write primitive scripts for the Unix shell. I wrote some simple scripts, and started executing them when I needed to. It was easier to manage the server. But I was still not satisfied with the results. Solving simple problems allowed me to think about more complex ones. I came to the conclusion that I wanted to have a single script that would perform the actions I specified. At the same time, I was promoted at work. It became necessary for me to be able to write more complex scripts. I realized that there would be no better learning opportunity for me. So I set about building pzct.</p>
<p>First I reiterated the basic mechanics that I already had as separate scripts, such as start, quit, and backup. I wrote a fairly simple, and I think successful, check to see if a server process was or was not running, which allowed me to perform or not perform actions on the server. The difficulty came in writing an in-game notification function before the server stops. I was helped with this by a person with the nickname joljaycups from Discord, for which I thank him. After that, through a combination of functions, I was able to get the restart option. This first key development moment allows me to introduce the pzct utility to you.</p>
<p>I had originally intended only for personal use of the script. However, if any of you find it useful, you can use pzct too. The main thing I have tried to implement so far is to be able to create a cron job to reboot the server at regular intervals. In this way I expect to solve the problem when a player can not connect to the server because of an unupdated mod on the server. Of course, this is not very convenient, because the mod update can happen soon after another reboot. But for the most part it should be enough. In its current form it already allows to leave the server running for a long time. Also, I will continue to improve the pzct utility, so its functionality will be extended in the future.</p>
<p>Note that in order for pzct to work, you need to have the rcon-cli program configured on your system. You can download it by going to https://github.com/itzg/rcon-cli. Since rcon-cli is not of my own design, we won't cover its configuration at this time. However, it should be fairly simple.</p>
<p>After you download the pzct.sh and pzct.conf files, open the pzct.conf file in an editor and fix the SERVDIR, ZDIR, LOGFILE, BAKDIR, CMDDIR, RCON, and RCONYAML parameters.</p>
<p>After doing this, open the pzct.conf file in an editor and fix the SERVDIR, ZDIR, LOGFILE, BAKDIR, CMDDIR, RCON, and RCONYAML parameters.</p>
<p>After that, open the pzct.sh file and find the line "INGAME NOTIFICATIONS BELOW", and in the two lines after that, change the notifications to your own.</p>
<p>After that, test the pzct utility. Correct the "/path/to" below to your own value:</p>
<p>1. Run the command "/path/to/pzct.sh quit" with the server running - the server should shut down with an in-game notification.</p>
<p>2. Run the command "/path/to/pzct.sh backup" - the file "bak.tar.gz" or "bak.tar.bz2" should appear in the directory you specified in the BAKDIR variable.</p>
<p>3. Run the command "/path/to/pzct.sh start" - your server should start.</p>
<p>4. Run the command "/path/to/pzct.sh message test1 test2" - you should see the text "test1 test2" in the game chat and in the middle of the game window.</p>
<p>If everything is OK, you should see the text "test1 test2" in the game window.</p>
<p>If everything is OK, that means you can create a cron job to automatically reboot the server. Run the command "crontab -e" and paste the text "0 0,8,16 * * * * nohup /path/to/pzct.sh restart &>/dev/null" on a new line if you want the server to restart daily at 0, 8 and 16 hours. Check the internet to find out how to handle cron on your system.</p>
<p>This project is an educational project for me. There are probably points in it that experienced people will find sub-optimal or incorrect. If you would like to suggest a fix or your own variation in the implementation of a point, feel free to do so. Although I have reached the minimum I had hoped for, I will continue to fix and improve the pzct utility in the future.</p>
<p>I would like to draw your attention to the fact that although I am distributing this script freely and for free, I ask you not to appropriate the results of my work. You are free to edit my script as you wish, but I ask that you do not distribute the script after you have edited it.</p>
<p>You can contact me on Telegram: https://t.me/vsnegupal or by emailing me at vsnegupal@gmail.com (quick response is not guaranteed).</p>
<p>Thank you for your attention!</p>