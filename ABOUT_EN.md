Hi everyone!
<p>In January 2022, I decided to start my own server for Project Zomboid. The conditions allowed me to use a separate computer at home for this. I was familiar with the GNU/Linux family of operating systems. So I decided that the server would run on a Linux computer.
<p>Managing the server, I realized that it was not easy at all. Management was all about executing commands in the console. Different actions required different commands. You either had to memorize these commands or refer to a list of them. Commands had to be executed in a certain sequence. All of this took a lot of time.
<p>At that time I knew how to write primitive scripts for the Unix shell. I wrote some simple scripts, and started executing them when I needed to. It was easier to manage the server. But I was still not satisfied with the results. Solving simple problems allowed me to think about more complex ones. I came to the conclusion that I wanted to have a single script that would perform the actions I specified.
<p>At the same time, I was promoted at work. It became necessary for me to be able to write more complex scripts. I realized that there would be no better learning opportunity for me. So I set about building pzct.
<p>First I reiterated the basic mechanics that I already had as separate scripts, such as start, quit, and backup. I wrote a fairly simple, and I think successful, check to see if a server process was or was not running, which allowed me to perform or not perform actions on the server.
<p>The difficulty came in writing an in-game notification function before the server stops. I was helped with this by a person with the nickname joljaycups from Discord, for which I thank him. After that, through a combination of functions, I was able to get the restart option. This first key development moment allows me to introduce the pzct utility to you.
<p>What was left to implement was to get real-time monitoring about mod updates. At the moment I expect to use pzct paired with cron. I created a cron job that runs the checkModsNeedUpdate wrapper every 5 minutes and reads the output of that command from the server-console.txt. This is enough to ensure that most users will not have problems logging into the server because of an unupdated mod on the server.
<p>This cron job can be run once a minute if you need it.
<p>Strictly speaking, it would be much more convenient if the checkModsNeedUpdate command outputs the result not only to server-console.txt, but also to a separate file. Then we would check that file instead of looking for lines in the general log. If you are TIS developer, maybe implement this query? Or maybe you just know how to redesign it. My contacts are below.
<p>After that I wrote a check function for all the variables used, which interrupts the script execution if the user does not have enough permissions for any action. I tested the script, and then I started to write a default manual that will allow you to quickly start using the script.
<p>What is left to add at the moment is: automatic addition of commands when typing, init/install option that will configure everything for the user, using conditionally default paths. I need to think about using getopt or getopts in the script, and figure it out.
<p>If you would like to suggest a fix or your own variation in the implementation of a point, feel free to do so. I'd be happy to team up with other enthusiasts, and together we'll give this utility a finished look and then present it to The Indie Stone.
<p>This project is an educational project for me. There are probably points in it that experienced people will find sub-optimal or incorrect. Although I have reached the minimum I had hoped for, I will continue to fix and improve the pzct utility in the future.
<p>I had originally intended only for personal use of the script. However, if any of you find it useful, you can use pzct too. I used only basic Unix commands and utilities in the script, so it should work the same in many popular Linux distributions. if it doesn't - let me know. The development is done in AlmaLinux 8.8.
<p>I would like to draw your attention to the fact that although I am distributing this script freely and for free, I ask you not to appropriate the results of my work. You are free to edit my script as you wish, but I ask that you do not distribute the script after you have edited it.
<p>You can contact me by visiting my Discord server: https://discord.gg/saKgQDutgB
<p>You can visit https://www.buymeacoffee.com/vsnegupal if you want to support me a little.
<p>Thank you for your attention!
