Всем привет!<p>
В январе 2022 года я решил запустить свой собственный сервер для игры Project Zomboid. Условия позволяли мне использовать для этого отдельный компьютер дома. Я был знаком с ОС семейства GNU/Linux. Поэтому я решил, что сервер будет работать на компьютере с Linux.<p>
Управляя сервером, я понял, что это совсем не просто. Управление сводилось к выполнению команд в консоли. Различные действия требовали выполнения различных команд. Нужно было либо запомнить эти команды, либо обращаться к их списку. Команды нужно было выполнять в определенной последовательности. Всё это занимало много времени.<p>
В то время я умел писать примитивные скрипты для Unix shell. Я написал несколько простых скриптов, и стал выполнять их, когда это было нужно. Управлять сервером стало проще. Но результат всё равно меня не устраивал. Решение простых задач позволяло подумать о более сложных. Я пришел к выводу, что хочу иметь один скрипт, который будет выполнять те или иные действия, которые я укажу.<p>
В это же время меня повысили на работе. Мне стало нужно уметь писать более сложные скрипты. Я понял, что лучшей возможности для обучения мне не представится. Поэтому взялся за сооружение pzct.<p>
Сначала я повторил основные механики, которые уже были у меня в виде отдельных скриптов, такие как start, quit и backup. Я написал довольно простую, и, как мне кажется, удачную проверку того, запущен или не запущен процесс сервера, что позволило выполнять или не выполнять действия с сервером.<p>
Сложность возникла при написании функции внутриигровых уведомлений перед остановкой сервера. С этим мне помог человек с никнеймом joljaycups из Discord, за что я выражаю ему благодарность. После этого, путем комбинации функций, я смог получить опцию restart.<p>
Оставалось реализовать мониторинг состояния модов в режиме реального времени. В данный момент я рассчитываю использовать pzct в паре с cron. Я создал задание в cron, которое раз в 5 минут выполняет команду checkModsNeedUpdate и читает вывод этой команды из файла server-console.txt. Этого вполне достаточно, чтобы большинство пользователей не имело проблем со входом на сервер из-за необновленного мода на сервере.<p>
Такое задание можно выполнять и раз в минуту, если вам это нужно.<p>
Строго говоря, было бы гораздо удобнее, если бы команда checkModsNeedUpdate выводила результат не только в server-console.txt, но и в какой-то отдельный файл. Тогда бы мы проверяли этот файл, а не искали строки в общем логе. Если вы - разработчик The Indie Stone, то, может быть, реализуете этот запрос? Либо, может быть, вы просто знаете, как это переделать. Мои контакты ниже.<p>
После этого я написал функцию проверки для всех используемых переменных, которая прерывает выполнение скрипта, если у пользователя недостаточно прав на какое-либо действие. Я протестировал работу скрипта, после чего взялся за написание дефолтного мануала, который позволит быстро начать пользоваться скриптом.<p>
Что осталось добавить, так это: автоматическое дополнение команд при вводе, init или install опцию, которая будет настраивать всё за пользователя, используя условно дефолтные пути. Нужно подумать об использовании getopt или getopts в скрипте, и разобраться с ними.<p>
Если вы хотите предложить исправление или свой вариант в реализации того или иного момента, то не стесняйтесь это сделать. Я буду рад объединиться с другими энтузиастами, и вместе мы придадим этой утилите законченный вид, а потом подарим ее The Indie Stone.<p>
Этот проект для меня является образовательным. В нем наверняка присутствуют моменты, которые опытные люди сочтут неоптимальными или неверными. Хотя я и достиг того минимума, на который расчитывал, но продолжу исправлять и улучшать утилиту pzct в будущем.<p>
Изначально я расчитывал только на личное пользование скриптом. Однако, если кому-то из вас это будет полезно, то вы тоже можете пользоваться pzct. В скрипте я использовал только базовые команды и утилиты Unix, так что он должен работать одинаково во многих популярных дистрибутивах Linux. если это не так - дайте мне знать. Разработка ведется в AlmaLinux 8.8.<p>
Я хочу обратить ваше внимание на то, что, хотя я свободно и бесплатно распространяю данный скрипт, однако я прошу вас не присваивать себе результаты моей работы. Вы можете редактировать мой скрипт так, как вам нужно, однако я прошу вас не распространять скрипт после того, как вы его отредактировали.<p>
Вы можете связаться со мной, посетив мой сервер Discord: https://discord.gg/saKgQDutgB<p>
Если хотите, можете посетить страницу https://www.buymeacoffee.com/vsnegupal<p>
Благодарю за внимание!
